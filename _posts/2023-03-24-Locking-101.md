---
layout: post
title:  "Locking 101：互斥锁研究概览"
date:   2023-03-24 20:57:23 +0800
categories: jekyll update
---

博士五年，其中近半的时间花在了研究多核同步上。说是多核同步，其实最终仅仅聚焦到互斥锁这一个小点上。互斥锁看似仅需提供互斥访问这一简单保证，但由于其承担着协同多个线程的重要作用且在性能关键路径上频繁使用，其性能表现将直接决定应用程序的最终性能。因此从互斥锁的本身机制、传递策略都有大量研究工作对其进行改进。然而，中文互联网上几乎没有对可扩展互斥锁相关研究的详尽介绍，甚至连相关的内容都较少。因此，本文想在毕业之际，把可扩展互斥锁研究的研究脉络、思路进行梳理，望能帮助开发、研究人员理解相关系统中的可扩展问题，也希望能启发新的小伙伴加入多核同步的研究。（大纲刚列完，更新时间随缘。）

# 初识互斥锁

## 基本概念

## 理论性能上限

## 现实很骨感

# 可扩展互斥锁研究

## 趋势

### 契合硬件，甚至微架构

硬件特性：Manycore, NUMA，AMP
微架构：ffwd

### 机制与策略：两者皆重要

从机制到策略：硬件特性复杂化使然。
机制：互斥锁实现本身的性能可扩展性。
策略：传递顺序会影响性能。

## 局限

### 假设，假设，假设

大部分研究工作均基于假设：非阻塞、线程绑核

### 摸到天花板？其实还很远

代理锁与理论性能上线。

## 未来

### Closed yet?

Of course not.

### 微架构matter

硬件Hint，clderemote。
Cache Movement。

### 正确性、合理性、衍生问题

正确性：避免死锁，实现正确性。
合理性：大部分应用程序的可扩展性不应该从互斥锁解决。不合理（粒度）的使用互斥锁才是主要问题。
衍生问题：优先级反转重要。

### 策略切换、定义、融合

HotOS paper.

# 结语

# Reference


